function verifyDapResize(n){var t=dapMgr.adCont;t[n].resizeCalled||dap_Resize(t[n].ifrmid,t[n].w,t[n].h)}function dap_Resize(n,t,i){document.getElementById(n).width=t,document.getElementById(n).height=i,t>0&&i>0&&dapMgr.saveAdResize(n,t,i)}function setCreativeData(n,t){dapMgr.creativeData[n]=t,t.Viewability&&t.Viewability=="true"&&microsoft.advertising.sdk.products.viewability.viewableImpression(50,document.getElementById(n),t)}function ShowAcb(){}var _dapUtils=new function(){var n=navigator.userAgent.toLowerCase(),u=navigator.appVersion.toLowerCase(),i=parseFloat(u),f=parseInt(i),e=n.indexOf("mac")!=-1,o,r,s,t;this.is_opera=n.indexOf("opera")!=-1,this.is_ff=n.indexOf("firefox")!=-1,r=u.indexOf("msie"),r!=-1&&(e?(r=n.indexOf("msie"),i=parseFloat(n.substring(r+5,n.indexOf(";",r)))):i=parseFloat(u.substring(r+5,u.indexOf(";",r))),f=parseInt(i),s=u.indexOf("trident/"),s!=-1&&(o=parseFloat(u.substr(s+8,3)))),t=r!=-1&&!this.is_opera,this.is_ie=t,this.is_ie5up=t&&i>=5,this.is_ie5_5=t&&n.indexOf("msie 5.5")!=-1,this.is_ie5_5up=t&&i>=5.5,this.is_ie6=t&&f==6,this.is_ie6up=t&&i>=6,this.is_ie9=t&&f==9,this.is_ie9down=t&&i<=9,this.is_ie9up=t&&i>=9,this.is_trident4up=t&&o>=4,this.is_trident5up=t&&o>=5,this.is_trident6up=t&&o>=6,this.is_win=n.indexOf("win")!=-1||n.indexOf("16bit")!=-1,e&&(this.is_win=!e),this.is_ff&&(this.ffPos=n.indexOf("firefox"),n.length>this.ffPos+8&&(f=parseInt(n.substring(this.ffPos+8))),n.length>this.ffPos+10&&(i=parseInt(n.substring(this.ffPos+10)))),this.is_mac=e,this.minorVer=i,this.majorVer=f,this.getCurrentStyle=function(n){return window.getComputedStyle?window.getComputedStyle(n,null)?window.getComputedStyle(n,null):document.defaultView.getComputedStyle(n,null):n.currentStyle}},dapMgr=new function(){var u=["//rad.msn.com/ADSAdClient31.dll?GetSAd=","//a.rad.msn.com/ADSAdClient31.dll?GetSAd=","//b.rad.msn.com/ADSAdClient31.dll?GetSAd="],i,o,r;this.creativeData={};var s=0,h=100,e=_dapUtils.is_ie&&_dapUtils.majorVer<8?2:6;this.adCont=[],i=!1,this.enableUnblockingOnload=function(n){i=n,n==!0&&dapMgr.setOnloadHandler(window,function(){dapMgr.enableUnblockingOnload(!1)})},o=function(n,t,i,r,u){this.qs=n,this.divid=t,this.ifrmid=i,this.w=r,this.h=u,this.resizeCalled=!1},this.renderAd=function(n,t,i,u){var f=this.adCont,e=r(n),s;if(e>-1)f[e].qs=t,f[e].divid=n,f[e].w=i,f[e].h=u;else{if(f.length<h)s=new o(t,n,"dapIfM"+f.length,i,u),f.push(s);else return;e=f.length-1}c(e)},this.saveAdResize=function(n,t,i){for(var u=this.adCont,r=0;r<u.length;r++)if(u[r].ifrmid==n){u[r].w=t,u[r].h=i,u[r].resizeCalled=!0;return}},this.enableACB=function(){},r=function(n){for(var t=0;t<dapMgr.adCont.length;t++)if(dapMgr.adCont[t].divid==n)return t},this.setOnloadHandler=function(n,t){var i=function(){n.attachEvent?(n.detachEvent("onload",i),t()):n.addEventListener&&(n.removeEventListener("load",i,!1),t())};n.attachEvent?n.attachEvent("onload",i):n.addEventListener&&n.addEventListener("load",i,!1)};var c=function(n){var o=dapMgr.adCont,a=u[Math.floor(s++%(u.length*e)/e)],h=document.getElementById(o[n].divid),v,y,c,r;if(!h)return;if(!o[n].qs||o[n].qs.length==0)return;v=_dapUtils.getCurrentStyle(h);if(v){y=v.display;if(y=="none"||y=="hidden")return}c=o[n].ifrmid,r=document.createElement("IFRAME"),r.id=c,r.name=c,r.src="about:blank",r.width=o[n].w,r.height=o[n].h,r.scrolling="no",r.frameBorder="0",r.allowTransparency=!0,a.length>0&&(a+="&DPJS=8"),(t.indexOf("&ID=")===-1||t.indexOf("&MUID=")===-1)&&(t=f()),a+=t;var b=o[n].qs.replace(/'/g,""),p=l(a+b,c,n),w=function(){var n;try{n=r.contentDocument||r.contentWindow.document}catch(t){n=null}n&&n.write?(n.write(p),_dapUtils.is_ie9down||_dapUtils.is_opera||n.close()):r.src="javascript:'"+p+"'"};_dapUtils.is_ie&&(_dapUtils.is_trident5up||i==!0&&(_dapUtils.majorVer>=8||_dapUtils.is_trident4up))?(h.insertBefore(r,h.firstChild),dapMgr.setOnloadHandler(r,function(){w()})):(h.insertBefore(r,h.firstChild),w())},l=function(n,t,i){var r='<html><head><title>Advertisement</title></head><body id="'+t+'" leftmargin="0" topmargin="0" style="background-color:transparent"><script type="text/javascript">var inDapIF=true; var inDapMgrIf=true;';return document.domain&&location.hostname!=document.domain&&(r+='document.domain="'+document.domain+'";'),r+='<\/script><script type="text/javascript">function startTimer(){if (event.srcElement.readyState == "complete") {parent.verifyDapResize('+i+');window.setTimeout("document.close();", 2000);}}<\/script><script type="text/javascript"  src="'+n+'" onreadystatechange="startTimer();" onload="parent.verifyDapResize('+i+');"><\/script></body></html>'},n=function(n,t,i){var u,r;if(n!=null){u=n.toLowerCase().indexOf(t.toLowerCase()+"=");if(u!=-1)return u+=t.length+1,r=n.indexOf(i,u),r=r==-1?n.length:r,n.substring(u,r)}return""},f=function(){var u=document.cookie,f=escape(n(u,"mh",";")),r=f!=""?"&PN="+f:"",t=escape(n(n(u,"ANON",";"),"A","&")),i=escape(n(u,"MUID",";"));return t==""&&(t=i),r+=t!=""?"&ID="+t:"",r+=i!=""?"&MUID="+i:""},t=f()};(function(){for(var a="microsoft.advertising.sdk.products",t=window,s=a.split("."),i,o=0;o<s.length;o++){i=s[o],typeof t[i]=="undefined"&&(t[i]={});if(typeof t[i]!="object")break;t=t[i]}var l=1e3,h,n={},f="/view/",e,r,u,c={PID:!0,UIT:!0,TargetID:!0,PG:!0,ASID:!0,ANID:!0,FN:!0};t.viewability={impressionEvents:{Viewed:"EV",ViewabilityUndetermined:"EVU"},isFrameViewable:function(n,t){return document.hasFocus()?this.isPercentOfAdOnWebpage(n,t)?this.isAdBlockerActive(t)?!1:!0:!1:!1},isAdBlockerActive:function(n){return n.height<=1},checkViewability:function(){for(var t in n){if(this.isNullOrUndefined(n[t].ifrm)){delete n[t],this.objectSize(n)>0||this.destroy();continue}this.isFrameViewable(n[t].percent,n[t].ifrm)&&(this.fireImpression(n[t].url+f+n[t].creativeData.CID+"?EVT="+this.impressionEvents.Viewed,n[t].creativeData),delete n[t],this.objectSize(n)>0||this.destroy())}},objectSize:function(n){var i=0,t;for(t in n)n.hasOwnProperty(t)&&i++;return i},fireImpression:function(n,t){var i=this.buildURL(n,t,c);this.sendImpression(i)},sendImpression:function(n){var t=new Image;t.src=n},buildURL:function(n,t,i){n.indexOf("?")===-1?n+="?":n.charAt(n.length-1)!=="?"&&n.charAt(n.length-1)!=="&"&&(n+="&");for(var r in t)t.hasOwnProperty(r)&&(!i||i[r])&&(n+=r+"="+t[r]+"&");return n+="msts="+ +new Date},viewableImpression:function(t,i,o){if(this.isNullOrUndefined(o))return;if(this.isNullOrUndefined(o.GSERV))return;o.CID||(o.CID="");if(this.isNullOrUndefined(i)){this.fireImpression(o.GSERV+f+o.CID+"?EVT="+this.impressionEvents.ViewabilityUndetermined,o);return}if(this.isNullOrUndefined(t)){this.fireImpression(o.GSERV+f+o.CID+"?EVT="+this.impressionEvents.ViewabilityUndetermined,o);return}if(this.invalidPercentage(t)){this.fireImpression(o.GSERV+f+o.CID+"?EVT="+this.impressionEvents.ViewabilityUndetermined,o);return}var s=this,h=t/100;n[i.id]&&this.restartTimer(),n[i.id]={percent:h,ifrm:i,creativeData:o,url:o.GSERV},this.objectSize(n)>1||(this.restartTimer(),e=function(){s.restartTimer()},r=function(){s.restartTimer()},u=function(){s.restartTimer()},this.registerEvent(window,"scroll","onscroll",e),this.registerEvent(window,"resize","onresize",r),this.registerEvent(window,"focus","onfocus",u))},restartTimer:function(){clearTimeout(h);var n=this;h=setTimeout(function(){n.checkViewability()},l)},registerEvent:function(n,t,i,r){n.addEventListener?n.addEventListener(t,r,!1):n.attachEvent&&n.attachEvent(i,r)},removeEvent:function(n,t,i,r){n.addEventListener?n.removeEventListener(t,r,!1):n.attachEvent&&n.detachEvent(i,r)},invalidPercentage:function(n){return n>100||n<0},isPercentOfAdOnWebpage:function(n,t){var i=t.getBoundingClientRect(),e=window.innerWidth||document.documentElement.clientWidth,f=window.innerHeight||document.documentElement.clientHeight,r,u;if(i.top>f)return!1;r=parseInt(t.width),u=parseInt(t.height),i.left<0?r=Math.max(0,i.left+parseInt(t.width)):i.right>e&&(r=Math.max(0,e-i.left)),i.top<0?u=Math.max(0,i.top+parseInt(t.height)):i.bottom>f&&(u=Math.max(0,f-i.top));var h=Math.max(1,parseInt(t.height)*parseInt(t.width)),s=r*u,o=s/h;return o>=n},destroy:function(){e&&this.removeEvent(window,"scroll","onscroll",e),r&&this.removeEvent(window,"resize","onresize",r),u&&this.removeEvent(window,"focus","onfocus",u)},isNullOrUndefined:function(n){return n==="undefined"||n===null}}})()